<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StackDonald 게임</title>
    <!-- 부트스트랩 링크 -->
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <!-- 내부 CSS -->
    <style>
        /* 배경색과 글자색 설정 */
        body {
            background-color: #f8f9fa; /* 배경색 */
            color: #333; /* 글자색 */
        }
        /* 순서 디스플레이 블록 스타일 */
        .order-display {
            display: none; /* 초기에는 숨김 */
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 10px;
            background-color: #fff;
            border: 1px solid #ccc;
            border-radius: 5px;
            box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);
        }
        /* 재료 디스플레이 블록 스타일 */
        .ingredients-display {
            display: none; /* 초기에는 숨김 */
            position: fixed;
            top: 20px;
            left: 20px;
            padding: 10px;
            background-color: #fff;
            border: 1px solid #ccc;
            border-radius: 5px;
            box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>
<body>

<!-- Hero 섹션 -->
<section class="hero-section text-center py-5">
    <div class="container">
        <!-- 제목 -->
        <h1 class="display-4">도전! 스택도날드(StackDonald)</h1>
        <!-- 소제목 -->
        <p class="lead">주어진 재료 스택(Stack)을 활용해서 맛있는 햄버거를 만들어봅시다!</p>
        <!-- "만들어보자!" 버튼 -->
        <button id="start-game-btn" class="btn btn-primary">만들어보자!</button>
    </div>
</section>

<!-- 순서 디스플레이 블록 -->
<div id="order-display" class="order-display">
    <h3>햄버거 재료 순서</h3>
    <ul>
        <li>빵</li>
        <li>야채</li>
        <li>고기</li>
        <li>빵</li>
    </ul>
</div>

<!-- 재료 디스플레이 블록 -->
<div id="ingredients-display" class="ingredients-display">
    <h3>주어진 재료</h3>
    <!-- 재료 쌓기 및 이전 버튼 -->
    <div class="text-center mt-3">
        <button id="stack-ingredients-btn" class="btn btn-primary mr-2">재료 쌓기</button>
        <button id="prev-ingredients-btn" class="btn btn-secondary">이전</button>
    </div>
</div>

<!-- 햄버거 디스플레이 블록 -->
<div id="burger-display" class="container text-center mt-5" style="display: none;">
    <div class="row justify-content-center">
        <div class="col-md-6">
            <h2>햄버거</h2>
            <!-- 사용자가 직접 재료를 클릭 or 드래그하면서 햄버거를 만들 수 있도록 기능 추가 예정 -->
        </div>
    </div>
</div>

<!-- 버튼 그룹 -->
<div id="button-group" class="container text-center mt-3" style="display: none;">
    <div class="row justify-content-center">
        <div class="col-md-6">
            <!-- 사용자 입력을 받는 폼 -->
            <form id="burger-form">
                <div class="form-group">
                    <label for="burger-input">만들 수 있는 햄버거의 개수는 몇 개인가요?</label>
                    <input type="text" class="form-control" id="burger-input" placeholder="햄버거 개수를 입력하세요.">
                </div>
                <button type="submit" class="btn btn-primary mb-2">확인</button>
            </form>
            <!-- 결과를 표시할 영역 -->
            <div id="result"></div>
            <!-- "다시하기" 버튼 -->
            <button id="reset-game-btn" class="btn btn-secondary mt-3">다시하기</button>
        </div>
    </div>
</div>

<!-- 부트스트랩 스크립트 추가 -->
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<script>    
    // 알고리즘 함수 정의
    function solution(ingredient) {
        let stk = [];
        let count = 0;
        for (let i = 0; i < ingredient.length; i++) {
            stk.push(ingredient[i]);
            if (
                stk[stk.length-1] === '빵' &&
                stk[stk.length-2] === '고기' &&
                stk[stk.length-3] === '야채' &&
                stk[stk.length-4] === '빵'
            ) {
                count++;
                stk.splice(-4);
            }
        }
        return count;
    }

    // 정답을 전역 변수로 선언
    let answer;

    // "만들어보자!" 버튼 클릭 시 이벤트 리스너
    document.getElementById('start-game-btn').addEventListener('click', function() {
        // 각 블록들과 입력 폼, 버튼들을 보이도록 설정
        document.getElementById('order-display').style.display = 'block';
        document.getElementById('ingredients-display').style.display = 'block';
        document.getElementById('burger-display').style.display = 'block';
        document.getElementById('button-group').style.display = 'block';
        document.getElementById('reset-game-btn').style.display = 'inline-block';
        // "만들어보자!" 버튼은 숨김
        this.style.display = 'none';

        // 임의의 재료를 생성하기 위한 재료 목록
        const ingredientsList = ['빵', '야채', '고기'];
        // 임의의 개수(6~20개)의 재료 생성
        const numIngredients = Math.floor(Math.random() * 15) + 6; // 6부터 20까지의 랜덤한 개수
        const randomIngredients = [];
        for (let i = 0; i < numIngredients; i++) {
            // 임의의 재료 선택
            const randomIndex = Math.floor(Math.random() * ingredientsList.length);
            randomIngredients.push(ingredientsList[randomIndex]);
        }
        // 생성된 재료를 HTML에 표시
        const ingredientsDisplay = document.getElementById('ingredients-display');
        ingredientsDisplay.innerHTML = '<h3>주어진 재료</h3><ul>';
        randomIngredients.forEach(ingredient => {
            ingredientsDisplay.innerHTML += `<li>${ingredient}</li>`;
        });
        ingredientsDisplay.innerHTML += '</ul>';
        
        // 재료 표시 블록 보이도록 설정
        ingredientsDisplay.style.display = 'block';

        // 알고리즘을 사용하여 햄버거를 만들 수 있는 횟수 계산
        answer = solution(randomIngredients);
    });

    // 폼 제출 시 이벤트 리스너
    document.getElementById('burger-form').addEventListener('submit', function(event) {
        event.preventDefault(); // 기본 동작 취소

        // 사용자 입력값 가져오기
        const userInput = parseInt(document.getElementById('burger-input').value.trim());

        // 정답과 비교
        if (userInput === answer) {
            // 정답일 경우 "정답!" 팝업 띄우기
            alert('정답!');
            if (answer === 0) {
                // 정답값이 0인 경우 초기화하고 처음 페이지로 돌아가기
                resetGame();
            } else {
                // 정답값이 0이 아닌 경우
                // "햄버거를 클릭하여 만들어보세요!" 안내문구와 "제작" 버튼 표시
                document.getElementById('burger-input').remove();
                document.querySelector('label[for="burger-input"]').innerText = '햄버거를 클릭하여 만들어보세요!';
                document.querySelector('button[type="submit"]').innerText = '제작';
                // "다시하기" 버튼 표시
                document.getElementById('reset-game-btn').style.display = 'inline-block';
                // '재료 쌓기' 버튼과 '이전' 버튼 표시
                document.getElementById('stack-ingredients-btn').style.display = 'inline-block';
                document.getElementById('prev-ingredients-btn').style.display = 'inline-block';
                }
        } else {
            // 오답일 경우 "오답!" 팝업 띄우기
            alert('오답! 다시 생각해보세요!');
        }
    });

    // "다시하기" 버튼 클릭 시 이벤트 리스너
    document.getElementById('reset-game-btn').addEventListener('click', function() {
        // 게임 초기화
        resetGame();
    });

    // 게임 초기화 함수
    function resetGame() {
        // 페이지 초기화
        document.getElementById('order-display').style.display = 'none';
        document.getElementById('ingredients-display').style.display = 'none';
        document.getElementById('burger-display').style.display = 'none';
        document.getElementById('button-group').style.display = 'none';
        document.getElementById('start-game-btn').style.display = 'inline-block';
        // 입력값 초기화
        document.getElementById('burger-input').value = '';
        // "다시하기" 버튼 숨김
        document.getElementById('reset-game-btn').style.display = 'none';
    }

    // 사용자가 직접 햄버거를 만들 수 있는 기능(함수로 정의함)
    function making() {
        // "주어진 재료" 메뉴의 각 재료 요소에 대해 drag 이벤트 리스너 추가
        const ingredientsListItems = document.querySelectorAll('#ingredients-display li');
        ingredientsListItems.forEach(item => {
            item.draggable = true;
            item.addEventListener('dragstart', dragStart);
        });

        // "햄버거" 블록에 drop 이벤트 리스너 추가
        const burgerDisplay = document.getElementById('burger-display');
        burgerDisplay.addEventListener('drop', drop);
        burgerDisplay.addEventListener('dragover', dragOver);
    }

    // "햄버거" 블록에 drop 이벤트가 발생했을 때 실행되는 함수
    function drop(event) {
        event.preventDefault();
        const data = event.dataTransfer.getData('text');
        event.target.innerHTML = ''; // "햄버거" 블록 내용 비우기
        event.target.appendChild(document.getElementById(data)); // 해당 재료 추가
    }

    // "햄버거" 블록 위에 다른 요소를 올려놓았을 때의 이벤트 처리 함수
    function dragOver(event) {
        event.preventDefault();
    }

    // "주어진 재료" 메뉴에서 재료를 drag하는 이벤트 처리 함수
    function dragStart(event) {
        event.dataTransfer.setData('text', event.target.id);
        event.target.style.display = 'none'; // 해당 재료 숨기기
    }
</script>
</body>
</html>
